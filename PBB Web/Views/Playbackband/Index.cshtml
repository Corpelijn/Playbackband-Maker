@{
    ViewBag.Title = "Index";
}

@if (!PBB_Web.Classes.SessionClass.IsAuthorized())
{
    Response.Redirect("~");
}

<div class="panel panel-default">

    <!-- /.panel-heading -->
    <div class="panel-heading">
        <div class="col-md-1 col-xs-1">
            <a href=@Url.Action("main", "playbackband")><input class="col-md-11 col-xs-11 btn btn-warning btn-xs" type="submit" value="< Terug" data-target=""></a>
            <div class="col-md-1 col-xs-1"></div>
        </div>
        <div class="col-md-2 col-xs-2 btn btn-primary btn-xs">Playbackband aanpassen</div>
        <div class="col-md-7 col-xs-7"></div>
        <a href="@Url.Action("DownloadExcel")"><input class="col-md-2 col-xs-2 btn btn-success btn-xs" value="Downloaden als Excel document"></a>
        <br />
    </div>

    <div class="panel-body">
        <div class="table-responsive">
            <table class="table table-hover">
                <thead>
                    <tr>
                        <th>NR.</th>
                        <th>ARTIEST / TITEL</th>
                        <th>I.D.</th>
                        <th style="text-align: center;">FRAGMENT</th>
                        <th>TIJD</th>
                        <th style="text-align: center;">BEGIN<br />
                            TOT. TIJD</th>
                        <th>NA(A)MEN UITVOERDERS<br />
                            WIJZE VAN UITVOEREN</th>
                        <th style="text-align: center;">BELICHTING<br />
                            TV = theaterverlichting</th>
                        <th colspan="4" style="text-align: center;">OPKOMST | AFGAAN<br />
                            L / R vanuit zaal gezien</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    @{int index = 0; int totalTime = 0;}
                    @if (PBB_Web.Classes.Domain.Playbackband.Instance == null || !PBB_Web.Classes.Domain.Playbackband.Instance.IsValid())          
                    {
                        Response.Redirect(Url.Action("main", "playbackband"));
                    }
                    @for (int i = 0; i < PBB_Web.Classes.Domain.Playbackband.Instance.Blokken.Count; i++)
                    {
                        for (int j = 0; j < PBB_Web.Classes.Domain.Playbackband.Instance.Blokken[i].fragmenten.Length; j++)
                        {
                            <tr class=" @if (PBB_Web.Classes.Domain.Playbackband.Instance.Blokken[i].fragmenten[j] != null)
                                        {
                                            if (PBB_Web.Classes.Domain.Playbackband.Instance.Blokken[i].fragmenten[j].rodedraad)
                                            { @("danger") }} ">
                            
                                
                            <td>@((index += 1).ToString("00"))</td>
                                

                            @if (PBB_Web.Classes.Domain.Playbackband.Instance.Blokken[i].fragmenten[j] != null)
                            {            
                                <td>
                                    @if (j == 0)
                                    { <b> @PBB_Web.Classes.Domain.Playbackband.Instance.Blokken[i].titel &nbsp;</b> }
                                    @PBB_Web.Classes.Domain.Playbackband.Instance.Blokken[i].fragmenten[j].liedje.ToString()
                                </td>
                                <td>@PBB_Web.Classes.Domain.Playbackband.Instance.Blokken[i].fragmenten[j].liedje.GetTaal()</td>
                                <td style="text-align: center;">@TimeSpan.FromSeconds(PBB_Web.Classes.Domain.Playbackband.Instance.Blokken[i].fragmenten[j].begintijd).ToString("mm\\.ss") - @TimeSpan.FromSeconds(PBB_Web.Classes.Domain.Playbackband.Instance.Blokken[i].fragmenten[j].eindtijd).ToString("mm\\.ss")</td>
                                <td>@(PBB_Web.Classes.Domain.Playbackband.Instance.Blokken[i].fragmenten[j].eindtijd - PBB_Web.Classes.Domain.Playbackband.Instance.Blokken[i].fragmenten[j].begintijd)</td>
                                <td style="text-align: center;">@TimeSpan.FromSeconds((double)(totalTime += (int)(PBB_Web.Classes.Domain.Playbackband.Instance.Blokken[i].fragmenten[j].eindtijd - PBB_Web.Classes.Domain.Playbackband.Instance.Blokken[i].fragmenten[j].begintijd))).ToString("mm\\.ss")</td>
                                <td>@PBB_Web.Classes.Domain.Playbackband.Instance.Blokken[i].fragmenten[j].GetUitvoerders() @(PBB_Web.Classes.Domain.Playbackband.Instance.Blokken[i].fragmenten[j].uitvoerwijze == "" ? "" : "/") @PBB_Web.Classes.Domain.Playbackband.Instance.Blokken[i].fragmenten[j].uitvoerwijze</td>
                                <td style="text-align: center;">@PBB_Web.Classes.Domain.Playbackband.Instance.Blokken[i].fragmenten[j].GetVerlichting()</td>
                                <td></td>
                                <td style="text-align: center;">@PBB_Web.Classes.Domain.Playbackband.Instance.Blokken[i].fragmenten[j].opkomst</td>
                                <td style="text-align: center;">@PBB_Web.Classes.Domain.Playbackband.Instance.Blokken[i].fragmenten[j].afgaan</td>
                                <td></td>
                                <td style="text-align: center;">
                                    @using(Html.BeginForm("IndexEdit","playbackband"))
                                    {
                                        <input type="hidden" value="@i" name="blok" />
                                        <input type="hidden" value="@j" name="fragment" />
                                        <button class="btn btn-primary btn-xs" type="submit">Bewerken</button>
                                    }
                                </td>
                            }
                            else
                            {
                                <td>
                                    @if (j == 0)
                                    { <b> @PBB_Web.Classes.Domain.Playbackband.Instance.Blokken[i].titel &nbsp;</b> }
                                    <i style="color: darkgray;">Klik op "Toevoegen" om hier een liedje in te voegen</i>
                                </td>
                                <td></td>
                                <td style="text-align: center;">00.00 - 00.00</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td style="text-align: center;"></td>
                                <td></td>
                                <td style="text-align: right;"></td>
                                <td></td>
                                <td style="text-align: center;"></td>
                                <td style="text-align: center;"><div class="btn btn-primary btn-xs btn-outline">Toevoegen</div></td>
                            }
                        </tr>
                        }
                    }
                </tbody>
            </table>
        </div>
        <!-- /.table-responsive -->
    </div>
    <!-- /.panel-body -->
</div>
<!-- /.panel -->

